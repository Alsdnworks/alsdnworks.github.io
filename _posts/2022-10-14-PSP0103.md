---
title: ë¬¸ì œí•´ê²°í”„ë¡œê·¸ë˜ë° ì œ 1,2,3ê°• ì‘ì„±ì¤‘[KNU 2022-2]
categories:
  - KNU
tags:
  - MathematicalModel
toc: true
---

# ğŸ‘¨â€ğŸ’»ğŸ«KNU 2022-2 SW & media ë¬¸ì œí•´ê²°í”„ë¡œê·¸ë˜ë° 1,2,3

# ì œ 1ê°•

## ë¬¸ì œí•´ê²°ì˜ ê³¼ì •

ë¬¸ì œí•´ê²°ì˜ ê³¼ì •ì€ ë¬¸ì œ ë° ëª©ì  ì„¤ì •ì˜ ìˆœì„œëŠ” ë‹¤ìŒê³¼ ê°™ì´ ì´ë£¨ì–´ì§„ë‹¤

1. ë°ì´í„° ì „ì²˜ë¦¬ ë° ë¶„ì„
2. ëª¨ë¸ì„¤ì • ë³€ìˆ˜ì¶”ì •
3. ì„±ëŠ¥í‰ê°€

ë¬¸ì œí•´ê²°ì˜ ëª©ì ì€ ë¶„ì„ / ì˜ˆì¸¡ / ìµœì í™”ë¡œ ë‚˜ëˆ„ì–´ì§„ë‹¤.

## ëª¨ë¸ íŠ¹ì§•ê³¼ ì„ íƒ

|ë³µì¡ë„|ëª¨ë¸|íŠ¹ì§•|
|-|-|-|
|ë‹¨ìˆœ-ì í•©ì„±ê³¼ ì •í™•ë„ê°€ ë‚®ë‹¤, ê³¼ì†Œì í•©ë˜ê¸° ì‰½ë‹¤|ìˆ˜í•™ëª¨ë¸|ì›ë¦¬ ì´í•´|
||í†µê³„ëª¨ë¸|í†µê³„ì  ì¶”ë¡ |
|ë³µì¡-ì í•©ì„±ê³¼ ì •í™•ë„ê°€ ë†’ë‹¤, ê³¼ëŒ€ì í•©ë˜ê¸° ì‰½ë‹¤.|ë¨¸ì‹ ëŸ¬ë‹|ì‘ìš©ì§€í–¥í˜• ëª¨ë¸|

## ëœ¨ê±°ìš´ ìƒ¤ì›Œë¬¼ì˜ ë²•ì¹™

- ìƒ¤ì›Œê¸°ì˜ ì˜¨ë„ ì¡°ì ˆê¸°ë¥¼ í†µí•´ ë‚´ê°€ ì›í•˜ëŠ” ì˜¨ë„ë¥¼ ì°¾ì„ ìˆ˜ìˆëŠ”ê°€
- ë‚´ê°€ ì›í•˜ëŠ” ì˜¨ë„ì— ë„ë‹¬í•˜ë ¤ë©´ ì–¼ë§ˆë‚˜ ë§ì€ ì‹œê°„ì´ ê±¸ë¦¬ëŠ”ê°€
- ë‚´ê°€ ì›í•˜ëŠ” ë¬¼ì˜ ì˜¨ë„ì™€ í˜„ì¬ ë¬¼ì˜ ì˜¨ë„ ì°¨ì´ ë§Œí¼ ëœ¨ê±°ìš°ë©´ ì°¨ê°‘ê²Œ, ì°¨ê°€ìš°ë©´ ëœ¨ê²ê²Œ ë ˆë²„ë¥¼ ë°˜ëŒ€ë¡œ ëŒë¦°ë‹¤.

$$\dot{x}(t)=-ax(t-h)$$

## ìˆ˜í•™ì  í•´ê²° ë°©ë²• : ìˆ˜ë¦¬ ëª¨ë¸ë§

- ì‹¤ì„¸ê³„ í˜„ìƒ (ë¬¸ì œ ìƒí™©)

-> ì•Œê³ ë¦¬ì¦˜ ê°œë°œ (ê´€ì°° ë° í‘œí˜„ ë‹¨ìˆœí™”, í˜•ì‹í™”, ex:ê° ì¬ì§ˆ ê·¸ë¬¼ ë³„ ì–´íšëŸ‰)

- ìˆ˜í•™ì  ëª¨ë¸

-> í’€ì´ (ìˆ˜í•™ì  ë¶„ì„, ex:ì–´íšì‹œí–‰íšŸìˆ˜, ì–´íšì¤‘ëŸ‰, í‰ê· ì¤‘ëŸ‰)

- ìˆ˜í•™ì  ê²°ê³¼ (ëª¨ë¸ë‚´ì—ì„œì˜ í•´)

-> í˜„ìƒí•´ì„<br>

ex:<br>
->ì§‘ë‹¨ê°„ ë¹„êµê°€ ê°€ì¥ ì‰¬ìš´ ë°©ë²•ì€ -> í‰ê· <br>
->í‰ê· ì´ ì°¨ì´ê°€ ìˆëŠ”ì§€ ì—†ëŠ”ì§€ ì•Œ ìˆ˜ìˆëŠ” ë°©ë²•<br>
->í†µê³„ì˜ ê°€ì„¤ ê²€ì • ë°©ë²•ìœ¼ë¡œ Kruskal-Wallis H ê²€ì •ì„ ì‚¬ìš©í•œë‹¤.

- ê²°ë¡  ì˜ˆì¸¡ (íŒë‹¨)

-> ê²€ì¦ (íƒ€ë‹¹ì„±ê³¼ ì •í™•ì„±, ex:ê·¸ë£¹ê°„í‰ê· ì°¨ì´, í†µê³„ëŸ‰, p-valueë¡œ ëª¨ë¸ì˜ ì„±ëŠ¥ì„ í‰ê°€, ê²€ì¦ ì‹¤ì‹œ)

- ì‹¤ì„¸ê³„ í˜„ìƒ (ë¬¸ì œ ìƒí™©)

## í†µê³„ì  í•´ê²° ë°©ë²• : ê°€ì„¤ ê²€ì •, í†µê³„ë¶„ì„

- ë¬¸ì œì •ì˜

-> ëª¨ì§‘ë‹¨ì˜ ì •ì˜, í‘œë³¸ì¶”ì¶œ(ex: ì§€ì—­ë³„ SFTS ë°œë³‘ë¥ )

- ë°ì´í„° ìˆ˜ì§‘

-> í†µê³„ì²˜ë¦¬, ì»´í“¨í„° ì…ë ¥, ìˆ˜í–‰(ex: ê¸°ê°„ë³„ SFTS ë°œë³‘ì‹œ ê¸°ìƒìë£Œ)

- ë°ì´í„° ì •ë¦¬ ë° ë¶„ì„

-> ê²°ë¡  ìœ ë„(ex: UnivariateFeatureSelection, Correlation)

- ë¶„ì„ê²°ê³¼ í•´ì„ ë° ì˜ì‚¬ê²°ì •
  
-> ë¬¸ì œì˜ ë°˜ì˜ ë° ì¡°ì¹˜(ex: MSE, RMSE, R2, FeatureImportanceì‚°ì • ë“±)

- ë¬¸ì œì •ì˜

## ë¨¸ì‹ ëŸ¬ë‹ì  í•´ê²° ë°©ë²•

1.&nbsp;ë¬¸ì œì˜ ì´í•´

- ë¬¸ì œì´í•´(ë°°ê²½, ëª©ì , ìœ í˜•)<br>
- í‰ê°€ì§€í‘œ(í‰ê°€ë°©ë²•, í‰ê°€ê¸°ì¤€)<br>

2.&nbsp; íƒìƒ‰ì  ë°ì´í„° ë¶„ì„

- ë°ì´í„° êµ¬ì¡° íƒìƒ‰<br>
- ë°ì´í„° ì‹œê°í™”(ì¤‘ìš” í”¼ì²˜ íŒŒì•…)<br>

3.&nbsp;ë² ì´ìŠ¤ë¼ì¸ ëª¨ë¸

- ëª¨ë¸ í›ˆë ¨ ë° ì„±ëŠ¥ ê²€ì¦<br>
- ê²°ê³¼ ì˜ˆì¸¡ ë° ì œì¶œ<br>

4.&nbsp;ì„±ëŠ¥ ê°œì„ 

- í”¼ì²˜ì—”ì§€ë‹ˆì–´ë§<br>
- í•˜ì´í¼íŒŒë¼ë¯¸í„° ìµœì í™”<br>
- ì„±ëŠ¥ê²€ì¦(í”¼ì²˜ì—”ì§€ë‹ˆì–´ë§, ë°ì´í„°ì‹œê°í™”, í‰ê°€ì§€í‘œ íŒŒì•…)<br>
- ê²°ê³¼ ì˜ˆì¸¡ ë° ì œì¶œ<br>

|ë¶„ë¥˜|ì¢…ë¥˜|
|-|-|
|ë¶„ë¥˜ì™€ íšŒê·€|íšŒê·€í‰ê°€ì§€í‘œ|
|ë¶„ë¥˜ í‰ê°€ì§€í‘œ|ì˜¤ì°¨í–‰ë ¬(ì •í™•ë„, ì •ë°€ë„, ì¬í˜„ìœ¨, F1ì ìˆ˜), ë¡œê·¸ì†ì‹¤, ROC|
|ë°ì´í„°ì¸ì½”ë”©|ë ˆì´ë¸”ì¸ì½”ë”©, ì›-í•«ì¸ì½”ë”©|
|í”¼ì²˜ìŠ¤ì¼€ì¼ë§|min_maxì •ê·œí™”, í‘œì¤€í™”|
|êµì°¨ê²€ì¦|Kfold, ì¸µí™”Kfold|
|ì£¼ìš”ë¨¸ì‹ ëŸ¬ë‹ëª¨ë¸|ì„ í˜•íšŒê·€, ë¡œì§€ìŠ¤í‹±íšŒê·€, ê²°ì •íŠ¸ë¦¬, ì•™ìƒë¸”, ëœë¤í¬ë ˆìŠ¤íŠ¸, XGBoost, LightGBM|
|í•˜ì´í¼íŒŒë¦¬ë¯¸í„° ìµœì í™”|ê·¸ë¦¬ë“œì„œì¹˜, ëœë¤ì„œì¹˜, ë² ì´ì§€ì•ˆ ìµœì í™”|

# ì œ 2ê°•

## ë¬¸ì œì„¤ì •

1. ì½”ë¡œë‚˜19ê°ì—¼ë³‘ í™•ì‚°ê³¼ì •ì„ ë°ì´í„°ë¥¼ í†µí•´ ê´€ì°°í•˜ê³  í™•ì‚°ì–‘ì‚°ì„ ëª¨ë¸ë¡œ ë‚˜íƒ€ë‚¸ë‹¤.
2. ì½”ë¡œë‚˜ í™•ì‚°ì€ ì–´ë–»ê²Œ ê²°ì •ë˜ëŠ”ê°€? ì§ˆë³‘ì€ ì‹œê°„ì´ ì§€ë‚˜ë©´ ì‚¬ë¼ì§€ëŠ”ê°€?
3. ê°ì—¼ë³‘ì´ ë°œìƒí–ˆì„ì‹œ í™•ì‚°ì„ ëŠ¦ì¶”ëŠ” ë°©ë²•ìœ¼ë¡œëŠ” ì–´ë–¤ê²ƒì´ ìˆëŠ”ê°€? ê·¸ ë°©ë²•ì˜ íš¨ê³¼ëŠ”
4. ë°±ì‹ ì ‘ì¢…ì˜ íš¨ê³¼ì™€ í™˜ì ê°ì†Œìœ¨ì„ ë¹„êµí•˜ì—¬ ì–´ë–¤ê²ƒì´ ë” íš¨ê³¼ì ì¸ì§€ ì•Œì•„ë³¸ë‹¤
5. ë°±ì‹ ì˜ íš¨ê³¼ì ì¸ ì ‘ì¢…ì‹œê¸°ëŠ”?
6. ì í•©í•œ ì‚¬íšŒì ê±°ë¦¬ë‘ê¸° ë‹¨ê³„ ì‚°ì •, ì•ìœ¼ë¡œì˜ ê°ì—¼ììˆ˜ ì–‘ìƒ ì˜ˆì¸¡

## 1.ì½”ë¡œë‚˜19ê°ì—¼ë³‘ í™•ì‚°ê³¼ì •ì„ ë°ì´í„°ë¥¼ í†µí•´ ê´€ì°°í•˜ê³  í™•ì‚°ì–‘ì‚°ì„ ëª¨ë¸ë¡œ ë‚˜íƒ€ë‚´ê¸°

> ì½”ë¡œë‚˜19ê°ì—¼ì ìˆ˜ì— ëŒ€í•œ ë°ì´í„°
> ì½”ë¡œë‚˜19ìˆ˜í•™ëª¨ë¸

### ê°ì—¼ë³‘ì˜ íŠ¹ì§•

- ëˆ„ê°€ ì–´ë–»ê²Œ ê°ì—¼ë˜ëŠ”ê°€?
- ëˆ„ê°€ ê°ì—¼ì‹œí‚¤ëŠ”ê°€?
- íšŒë³µì´ ê°€ëŠ¥í•œê°€?
- íšŒë³µí›„ ì¬ê°ì—¼ì´ ê°€ëŠ¥í•œê°€?

### ê°ì—¼ë³‘ì ìˆ˜ ìˆ˜í•™ëª¨ë¸

- $S$: ê°ì—¼ë  ìˆ˜ ìˆëŠ” ê·¸ë£¹
- $I$: ê°ì—¼ëœ ê·¸ë£¹
- $R$: íšŒë³µëœ ê·¸ë£¹

ì¼ë•Œ

- $\Delta$I: ë‹¤ìŒ ë‚  ê°ì—¼ëœ ì‚¬ëŒ ìˆ˜ì˜ ë³€í™”ëŸ‰
- $N$: ì „ì²´ ì¸êµ¬ìˆ˜
- $a$: í•˜ë£¨ê°„ ê°ì—¼ìê°€  ì‚¬ëŒì„ ë§ˆì£¼ì¹˜ëŠ” í‰ê· íšŸìˆ˜
- p: ê°ì—¼ìê°€ ì ‘ì´‰ í–ˆì„ë•Œì˜ ê°ì—¼ì‹œí‚¤ëŠ” í™•ë¥ 
- $\beta$: í•˜ë£¨ê°„ ê°ì—¼ìê°€  ì‚¬ëŒì„ ë§ˆì£¼ì¹˜ëŠ” í‰ê· íšŸìˆ˜ * ê°ì—¼ì‹œí‚¤ëŠ” í™•ë¥ ; ê°ì—¼ìƒìˆ˜$\beta=ap$

> ìƒˆë¡œ ê°ì—¼ëœ ì‚¬ëŒ ìˆ˜ëŠ” $\beta(\frac{S}{N})I$

- $\gamma$: íšŒë³µë¥ 

> ê°ì—¼ë˜ì—ˆë‹¤ê°€ íšŒë³µëœ ì‚¬ëŒ ìˆ˜ëŠ” $\gamma I$

ë”°ë¼ì„œ  ì´ì‚° ëª¨í˜•ìœ¼ë¡œ ë‚˜íƒ€ë‚¸ SIRëª¨ë¸ì€ ë‹¤ìŒê³¼ ê°™ë‹¤.

>$S_{t+1} = S_t - \beta S_t \frac{I_t}{N}$<br>
>$I_{t+1} = I_t + \beta S_t \frac{I_t}{N} - \gamma I_t$<br>
>$R_{t+1} = R_t + \gamma I_t$<br>

ì´ë¥¼ ì—°ì† ëª¨í˜•(ìƒë¯¸ë¶„ë°©ì •ì‹)ìœ¼ë¡œ ë‚˜íƒ€ë‚´ë©´ ë‹¤ìŒê³¼ ê°™ë‹¤.

>$\frac{d}{dt} S(t)= -\beta S(t) \frac{I(t)}{N}$<br>
>$\frac{d}{dt} I(t)= \beta S \frac{I}{N} - \gamma I(t)$<br>
>$\frac{d}{dt} R(t)= \gamma I(t)$<br>



### íŒŒì´ì¬ìœ¼ë¡œ ì‹œë®¬ë ˆì´ì…˜ í•´ë³´ê¸°

ë§Œë“¤ì–´ì§„ ëª¨ë¸ê³¼ í…Œì¼ëŸ¬ê¸‰ìˆ˜, ë£½ê²Œ-ì¿ íƒ€ ë°©ë²•ì„ ì´ìš©í•˜ì—¬ íŒŒì´ì¬ìœ¼ë¡œ ì‹œë®¬ë ˆì´ì…˜ì„ í•´ë³´ë„ë¡ í•œë‹¤.

~~~python
#defining the parameters
#time step
t0=0 #start time
tf=14 #end time
n=140 #number of time steps
h=(tf-t0)/n #time step size
time=np.linspace(t0,tf,n+1)

#condition parameters S,I,R
N=51839994 #from 2020 korea population
case1=6#from first covid infection of korea
init_values=1000=np.array([N,case,0])
x=np.array((n+1)*([init_values]))

#model parameters
beta=0.4
gamma=1/14
~~~

ë£½ê²Œ-ì¿ íƒ€ ë°©ë²•ì„ ì´ìš©í•˜ì—¬ ì‹œë®¬ë ˆì´ì…˜ì„ í•´ë³´ë©´ ë‹¤ìŒê³¼ ê°™ë‹¤.

>$RK4$ <br>
>$k_1 = f(t_i, y_i)$<br>
>$k_2 = f(t_i + \frac{h}{2}, y_i + \frac{k_1 h}{2})$<br>
>$k_3 = f(t_i + \frac{h}{2}, y_i + \frac{k_2 h}{2})$<br>
>$k_4 = f(t_i + h, y_i + k_3h)$<br>
>$y_{i+1} = y_i + \frac{1}{6}(k_1 + 2k_2 + 2k_3 + k_4)h$<br>

~~~python
#k1=[dS, dI, dR]
for i in range(n):
    S=x[i,0]
    I=x[i,1]
    R=x[i,2]
    dS=-beta*S*I/N
    dI=beta*S*I/N-gamma*I
    dR=gamma*I
    k1=np.array([dS,dI,dR])

    S=x[i,0]+k1[0]*h/2
    I=x[i,1]+k1[1]*h/2
    R=x[i,2]+k1[2]*h/2
    dS=-beta*S*I/N
    dI=beta*S*I/N-gamma*I
    dR=gamma*I
    k2=np.array([dS,dI,dR])

    S=x[i,0]+k2[0]*h/2
    I=x[i,1]+k2[1]*h/2
    R=x[i,2]+k2[2]*h/2
    dS=-beta*S*I/N
    dI=beta*S*I/N-gamma*I
    dR=gamma*I
    k3=np.array([dS,dI,dR])

    S=x[i,0]+k3[0]*h
    I=x[i,1]+k3[1]*h
    R=x[i,2]+k3[2]*h
    dS=-beta*S*I/N
    dI=beta*S*I/N-gamma*I
    dR=gamma*I
    k4=np.array([dS,dI,dR])

    x[i+1]=x[i]+(k1+2*k2+2*k3+k4)*h/6
~~~

ë‹¤ìŒì„ ê·¸ë˜í”„ë¡œ ë‚˜íƒ€ë‚´ë©´ ë‹¤ìŒê³¼ ê°™ë‹¤.

~~~python
S_t = x[:,0]
Simulated_NI = beta * S_t * I_t / N

plt.figure(figsize=(10,6))
t=time
I_t=x[:,1]
R_t=x[:,2]
lines=plt.plot(t, I_t, 'r' ,t, R_t, 'b')
plt.step(lines[0],lineswidth=3)
plt.step(lines[1],lineswidth=3)
plt.xlabel('time')
plt.ylabel('number of people')
plt.legend(['Infected','Recovered'],fontsize=15)
plt.title('SIR model')
plt.show()
~~~

ì‹¤ì œ ê°ì—¼ììˆ˜ì™€ì˜ ë¹„êµë¥¼ í•´ë³´ë©´ ë‹¤ìŒê³¼ ê°™ë‹¤.

> data=
>
> ||date|cases|
> |:---:|:---:|:---:|
> |0|2020-08-01|6|
> |1|2020-08-02|6|
> |2|2020-08-03|15|
> |3|2020-08-04|14|
> |4|2020-08-05|22|
> |5|2020-08-06|19|
> |6|2020-08-07|34|
> |7|2020-08-08|17|
> |8|2020-08-09|17|
> |9|2020-08-10|29|
> |10|2020-08-11 |45|
> |11|2020-08-12 |55|
> |12|2020-08-13 |142|
> |13|2020-08-14 |272|
> |14|2020-08-15 |178|
> |15|2020-08-16 |202|
> |16|2020-08-17 |293|
> |17|2020-08-18 |301|
> |18|2020-08-19 |317|
> |19|2020-08-20 |324|
> |20|2020-08-21 |341|
> |21|2020-08-22 |334|
> |22|2020-08-23 |214|
> |23|2020-08-24 |332|
> |24|2020-08-25 |416|

~~~python
plt.figure(figsize=(10,5))
t1=data.index[0:15]
t2=time
y1=data.loc[0:14,'cases']
y2=Simulation_NI
lines = plt.plot(t1,y1,'*b',t2,y2,'r')
plt.setp(lines[0], markersize=5)
plt.setp(lines[1], linewidth=3)
plt.xlabel('time')
plt.ylabel('Population')
plt.legend(('Observed cases','Simulation cases'),fontsize=10,loc='best')
plt.title('COVID-19')
plt.show()
~~~

# ì œ 3ê°•

## í•™ìŠµëª©í‘œ

- ì´ ì§ˆë³‘ì€ ì‹œê°„ì´ ì§€ë‚˜ë©´ ì‚¬ë¼ì§€ëŠ”ê°€
- ê°ì—¼ìƒìˆ˜ëŠ” ì–´ë–»ê²Œ êµ¬í•  ìˆ˜ ìˆëŠ”ê°€
- íšŒë³µ í›„ ì¬ê°ì—¼ ë  ìˆ˜ìˆëŠ” ì‚¬ëŒ $\delta I$ëŠ” ì–´ë–»ê²Œ êµ¬í•  ìˆ˜ ìˆëŠ”ê°€

ë³´ë„ìë£Œë¥¼ í†µí•œ 2íšŒê°ì—¼ ì†Œìš”ê¸°ê°„ì˜ íšë“ ë° ìƒìˆ˜ ì‚¬ìš© *(2íšŒê°ì—¼ì¼-1íšŒê°ì—¼ì¼)* $\delta=\frac{1}{229}$

ê¸°ì´ˆê°ì—¼ì¬ìƒì‚°ì§€ìˆ˜ $R_0=ê°ì—¼í™•ë¥ *ì ‘ì´‰ë¹ˆë„*ì „íŒŒê¸°ê°„=a*p*\frac{1}{\gamma}=\frac{\beta}{\gamma}$

ì´ë•Œ $R_0$ê°€ 1ë³´ë‹¤ í¬ë©´ ê°ì—¼ì´ ì§€ì†ë˜ê³  1ë³´ë‹¤ ì‘ìœ¼ë©´ ê°ì—¼ì´ ì‚¬ë¼ì§„ë‹¤.

$$
ê³ ì •ì ê³¼\;ì•ˆì •ì \;(Equilibrium \;point \;and \;Stability)
\\.\\
\\.\\
ê³ ì •ì ì´\;ë˜ë ¤ë©´\; S,I,R ê°ê°ì˜\; ë³€í™”ëŸ‰ì´\; 0ì´\; ë˜ì–´ì•¼í•œë‹¤.
\\
\frac{dS}{dt}=\frac{dI}{dt}=\frac{dR}{dt}=0ì˜\; ì—°ë¦½ë°©ì •ì‹ì„\; í’€ë©´\; ë‹¤ìŒê³¼\; ê°™ë‹¤.
\\
(\frac{\beta S}{N}-\gamma)I=0
\hspace{0.25cm}
\begin{cases}
case1&I=0  \\
case2&S=\frac{\gamma N}{\beta}
\end{cases}
\\.\\
\\.\\
case1.
\\
I=0ì´ë¼ë©´ S+I+R=Nì´ë¯€ë¡œ\;N-S-I= ì´ ë¨ì„ ì•Œ ìˆ˜ ìˆë‹¤.
\\
ë”°ë¼ì„œ\; ì²«\;ê³ ì •ì E_1=(N,0,0)ì´ê³ 
\\
ì´ëŠ”\; ê°ì—¼ìê°€\; ì—†ëŠ”\; ìƒíƒœì´ë‹¤.(disease-free-equilibrium)
\\.\\
\\.\\
case2.
\\
\frac{\gamma N}{\beta}ì´ë¼ë©´ S+I+R=Nì´ë¯€ë¡œ
\\
N-S-I\rightarrow\frac{\gamma}{\delta}Iê°€\;ëœë‹¤.
\\
S=\frac{\gamma N}{\beta}ì´ë¯€ë¡œ
\\
N-\frac{\gamma N}{\beta} = I+\frac{\gamma}{\delta}I

\rightarrow

N(1-\frac{\gamma}{\beta})=I(1+\frac{\gamma}{\delta})I
\\
I=\frac{1-\frac{\gamma}{\beta}}{1+\frac{\gamma}{\beta}}N
\\
R=\frac{\gamma}{\beta}.
\frac{1-\frac{\gamma}{\beta}}{1+\frac{\gamma}{\beta}}N=\frac{\gamma(1-\frac{\gamma}{\beta})}{\gamma+\delta}N
\\
ë”°ë¼ì„œ\; ë‘ë²ˆì§¸\;ê³ ì •ì E_2=(\frac{\gamma N}{\beta},\frac{1-\frac{\gamma}{\beta}}{1+\frac{\gamma}{\beta}}N,\frac{\gamma(1-\frac{\gamma}{\beta})}{\gamma+\delta}N)
\\.\\
\\.\\
ì´ëŠ”\; ì–‘ìˆ˜Iì˜\; ê³ ì •ì ì´\; ì¡´ì¬í•˜ê³ \; ê·¼ë°©ì˜\; ì‚°í¬ê°€\; ê³ ì •ì ì—\; ê·¼ì ‘í• ë•Œ\; ì§ˆë³‘ì€\; ì‚¬ë¼ì§€ì§€\; ì•ŠëŠ”ë‹¤.
\\
ê·¸ëŸ¬ë‚˜,\; E_1 ê·¼ë°©ì˜ (S\approx N, I>0) \\I'=(\frac{\beta S}{N}-\gamma)I \approx (\beta-\gamma)I
\\
\beta > \gamma ì¼ë•Œ \rightarrow (\beta - \gamma)I > 0
\\
\beta < \gamma ì¼ë•Œ \rightarrow (\beta - \gamma)I < 0
\\
\frac{1-\frac{\gamma}{\beta}}{1+\frac{\gamma}{\delta}}N>0 \rightarrow 1-\frac{\gamma}{\beta}>0
\\
\rightarrow\frac{\gamma}{\beta}<1
\\
\rightarrow\frac{\beta}{\gamma}>1
\\
ë”°ë¼ì„œ\; ê³ ì •ì ì´\; ì¡´ì¬í•˜ê¸°ìœ„í•´ \beta > \gamma ì´ì–´ì•¼í•œë‹¤.
$$

## í•¨ìˆ˜ ë° ì½”ë“œ ì¬ì •ì˜ 

~~~python
import numpy as np
import matplotlib.pyplot as plt
import pandas as pd

#def RK4(f, initial_value,t0,tf,n):
#  time = np.linspace(t0,tf,n+1)
#  x = np.array((n+1)*[initial_value])
#  h = time[1]-time[0]
#  for i in range(n):
#    k1 = h*f(x[i],time[i])
#    k2 = h*f(x[i]+k1/2,time[i]+h/2)
#    k3 = h*f(x[i]+k2/2,time[i]+h/2)
#    k4 = h*f(x[i]+k3,time[i]+h)
#    x[i+1] = x[i] + (k1+2*k2+2*k3+k4)/6
#  return x,time
#
#def f(u):
#  S,I,R = u
#  N = sum(u)
#  dS=-beta*S*I/N+delta*R
#  dI=beta*S*I/N-gamma*I
#  dR=gamma*I-delta*R
#  return np.array([dS,dI,dR])
#
#----->

def fit_F(u,beta):
  S, E, I, R = u
  N=sum(u)
  dS=-beta*S*I/N+delta*R
    #E'(t)=beta*S(t)*I(t)/N-alpha*E(t) 
  dE=beta*S*I/N-alpha*E
    #I'(t)=alpha*E(t)-gamma*I(t)
  dI=alpha*E/N-gamma*I
  dR=gamma*I-delta*R
  return np.array([dS, dE, dI, dR])

def rk4(f, initial_value, t0, tf, n, beta):
  time = np.linspace(t0,tf,n+1) #x_grid
  x = np.array((n+1)*[initial_value]) # array of state of the sys for each x
  h = time[1]-time[0] #step size
  for i in range(n): #4th order Runge-Kutta
    k0=fit_F(x[i],beta)
    k1 = h*f(x[i],beta)
    k2 = h*f(x[i]+k1/2,beta)
    k3 = h*f(x[i]+k2/2,beta)
    x[1+i]=x[i]+h*(k0+2*k1+2*k2+k3)/6
  return x,time

def diff_F(data_y, initial_value, t0, tf, n, x2):
  time, SIR_t = rk4(fit_F, initial_value, t0, tf, n, x2)
  Simulated_NI = alpha*SIR_t[:,1]
  diff=data_y-Simulated_NI[0:n+1:int((1/h)]
  MSE=np.dot(diff,diff)/len(diff)
  return MSE

#defining the parameters
#time step
t0=0 #start time
tf=15 #end time
n=150 #number of time steps
h=(tf-t0)/n #time step size
time=np.linspace(t0,tf,n+1)

#condition parameters S,I,R
N=51840000 #from 2020 korea population

#model parameters
alpha=1/5
beta=0.4  #ê°ì—¼ìƒìˆ˜-ë¯¸ì§€
gamma=1/14 #íšŒë³µë¥ 
delta=1/229 # 1/ì¬ê°ì—¼í‰ê· ì¼ìˆ˜ 

#ì´ë•Œ ê¸°ì´ˆ ì¬ìƒì‚°ìˆ˜ R_0=beta/gamma=0.4/0.0714=5.6ì´ë‹¤.
R_0=beta/gamma

#N_time, N_time = RK4(f, np.array([N-1,1,0]),t0,tf,n)
Simulation_NI = alpha* x[: , 1]

#plotting
plt.figure(figsize=(10,6))
t1=data.index[:16]
t2=time
y1=data.loc[15:,'cases']
y2=Simulation_NI
lines=plt.plot(t1,y1,'o',t2,y2,'-')
plt.setp(lines[0],markersize=10)
plt.setp(lines[1],linewidth=2)
plt.xlabel('Time')
plt.ylabel('Number of people')
plt.legend(('obs','sim'),loc='best')
plt.show()
~~~

